Public CalendarModified As Boolean

' This script is created by Yang Zhang an happy Intern of PTC!<(^_^)>
Sub CopyCalendarColumnsToMonthsWithCustomFormat()
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    MsgBox "Updating all Sheets of this excel!"
    
    Dim i As Integer
    Dim row As Integer
    Dim targetSheet As Worksheet
    Dim sourceSheet As Worksheet
    
    ' Set the Calendar sheet as the source sheet
    Set sourceSheet = Sheets("Calendar")
    
    ' Array of month sheet names (Jan to Dec)
    Dim monthNames As Variant
    monthNames = Array("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
    
    ' Loop through the 12 columns in Calendar sheet (B to M)
    For i = 1 To 12
        ' Set the target sheet based on the month name
        Set targetSheet = Sheets(monthNames(i - 1))
        
        targetSheet.Range("B8").Value = 8
        
        ' Loop through rows 3 to 33 in Calendar sheet and rows 2 to 32 in the target sheet
        For row = 3 To 33
            ' MsgBox "Operating on sheet:" & monthNames(i - 1)
            ' Copy the value and format from Calendar to the corresponding month sheet's G column (column 7)
            targetSheet.Cells(row - 1, 7).Value = sourceSheet.Cells(row, i + 1).Value
            targetSheet.Cells(row - 1, 7).Interior.Color = sourceSheet.Cells(row, i + 1).Interior.Color
            targetSheet.Cells(row - 1, 7).Font.Color = sourceSheet.Cells(row, i + 1).Font.Color
            targetSheet.Cells(row - 1, 7).HorizontalAlignment = sourceSheet.Cells(row, i + 1).HorizontalAlignment
            targetSheet.Cells(row - 1, 7).VerticalAlignment = sourceSheet.Cells(row, i + 1).VerticalAlignment
            targetSheet.Cells(row - 1, 7).Font.Bold = sourceSheet.Cells(row, i + 1).Font.Bold

            ' If not empty, copy the corresponding date from A3:A33 to F2:F32
            If sourceSheet.Cells(row, i + 1).Value <> "" Then
                targetSheet.Cells(row - 1, 6).Value = sourceSheet.Cells(row, 1).Value
                targetSheet.Cells(row - 1, 6).Interior.Color = sourceSheet.Cells(row, 1).Interior.Color
                targetSheet.Cells(row - 1, 6).Font.Color = sourceSheet.Cells(row, 1).Font.Color
                targetSheet.Cells(row - 1, 6).HorizontalAlignment = sourceSheet.Cells(row, 1).HorizontalAlignment
                targetSheet.Cells(row - 1, 6).VerticalAlignment = sourceSheet.Cells(row, 1).VerticalAlignment
                targetSheet.Cells(row - 1, 6).Font.Bold = sourceSheet.Cells(row, 1).Font.Bold
                targetSheet.Cells(row - 1, 6).NumberFormat = sourceSheet.Cells(row, 1).NumberFormat
                
                ' Set the appropriate value in K column based on color
                Select Case sourceSheet.Cells(row, i + 1).Interior.Color
                    Case RGB(0, 112, 192): ' Weekend
                        targetSheet.Cells(row - 1, 11).Value = "Weekend"
                    Case RGB(192, 0, 0): ' Public holiday
                        targetSheet.Cells(row - 1, 11).Value = "Public holiday"
                    Case RGB(255, 192, 0): ' VGC 1/2 -DAY
                        targetSheet.Cells(row - 1, 11).Value = "VGC 1/2 -DAY"
                    Case Else: ' Work day
                        targetSheet.Cells(row - 1, 11).Value = "Working day"
                End Select
            Else
                ' If empty, clear the corresponding F column cell (date)
                targetSheet.Cells(row - 1, 6).ClearContents
                targetSheet.Cells(row - 1, 6).Interior.ColorIndex = xlNone
                targetSheet.Cells(row - 1, 6).Font.ColorIndex = xlAutomatic
                targetSheet.Cells(row - 1, 6).HorizontalAlignment = xlGeneral
                targetSheet.Cells(row - 1, 6).VerticalAlignment = xlCenter
                targetSheet.Cells(row - 1, 6).Font.Bold = False
                targetSheet.Cells(row - 1, 6).NumberFormat = "General"
            End If
        Next row
    Next i
    
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic

End Sub
' This script is created by Yang Zhang an happy Intern of PTC!<(^_^)>
